<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <link rel="stylesheet" href="style.css" />
  <title>JupyterLab Server Configuration</title>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>JupyterLab Server Configuration</h1>
      <p style="margin: 8px 0 0 0; opacity: 0.9;">Choose your computing environment and resources</p>
    </div>

    <div class="content">
      <!-- Step Navigation -->
      <div class="step-nav">
        <div class="step active" data-step="1">
          <div class="step-number">1</div>
          <div class="step-text">Profile</div>
        </div>
        <div class="step" data-step="2">
          <div class="step-number">2</div>
          <div class="step-text">Configuration</div>
        </div>
        <div class="step" data-step="3">
          <div class="step-number">3</div>
          <div class="step-text">Launch</div>
        </div>
      </div>

      <form action="{{ url }}" method="post" id="spawn-form">
        <!-- Step 1: Profile Selection -->
        <div class="step-content active" data-step="1">
          <h2>Choose Computing Profile</h2>
          <div id="api-status"></div>

          <div class="profile-grid" id="profile-grid">
            <!-- Profiles will be loaded dynamically -->
          </div>

          <div class="nav-buttons">
            <div></div>
            <button type="button" class="btn btn-primary" onclick="nextStep(2)">Continue</button>
          </div>
        </div>

        <!-- Step 2: Configuration -->
        <div class="step-content" data-step="2">
          <h2>Environment Configuration</h2>

          <!-- Single Node Configuration -->
          <div id="single-node-config">
            <label for="image">Docker Image:</label>
            <select name="image" id="image-select" required>
              <option value="danielcristh0/jupyterlab:cpu" data-desc="CPU-only JupyterLab for basic tasks">CPU Image (Basic)</option>
              <option value="danielcristh0/jupyterlab:gpu" data-desc="GPU-enabled JupyterLab with CUDA support">GPU Image (ML/AI)</option>
            </select>
            <div id="image-info" class="message message-info"></div>

            <div id="cluster-status"></div>
            <div id="node-selection"></div>
          </div>

          <!-- Multi Node Configuration -->
          <div id="multi-node-config" class="hidden">
            <div class="multi-node-config">
              <h3>Multi-Node Cluster Configuration</h3>
              <div id="multi-node-summary"></div>

              <div class="message message-info">
                Multi-node setup will automatically distribute computing tasks across allocated nodes.
              </div>

              <div id="allocated-nodes" class="node-grid"></div>
            </div>
          </div>

          <div class="nav-buttons">
            <button type="button" class="btn btn-secondary" onclick="prevStep(1)">Back</button>
            <button type="button" class="btn btn-primary" onclick="nextStep(3)">Continue</button>
          </div>
        </div>

        <!-- Step 3: Launch -->
        <div class="step-content" data-step="3">
          <h2>Ready to Launch</h2>

          <div id="launch-summary"></div>

          <div class="nav-buttons">
            <button type="button" class="btn btn-secondary" onclick="prevStep(2)">Back</button>
            <button type="submit" class="btn btn-success">Start JupyterLab Server</button>
          </div>
        </div>

        <!-- Hidden form fields -->
        <input type="hidden" name="profile_id" id="input-profile-id" />
        <input type="hidden" name="node" id="input-node" />
        <input type="hidden" name="node_ip" id="input-node-ip" />
        <input type="hidden" name="session_config" id="input-session-config" />
      </form>
    </div>
  </div>

  <script src="main.js"></script>
</body>
</html>